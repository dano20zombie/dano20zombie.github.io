<!DOCTYPE html>
<html lang="ar">
<head>
  
    <title>CppOnionBridge: الابتكار في الوصول المجهول إلى الإنترنت :: مدونة دانو20زومبي</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="استكشف CppOnionBridge، الحل النهائي لتصفح الإنترنت بشكل مجهول. يستكشف هذا المنشور كيف يوفر المشروع وصولًا آمنًا ومحميًا إلى مواقع البصل وواجهات برمجة التطبيقات من خلال شبكة Tor، مؤكدًا أهمية الخصوصية والأمان على الإنترنت في عصر رقمي. مثالي لمستخدمي Windows الذين يسعون إلى تعزيز تجربتهم عبر الإنترنت مع الحفاظ على هويتهم الرقمية محمية." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://dano20zombie.github.io/ar/posts/cpponionbridge/" />






  
  
  
  
  
  <link rel="stylesheet" href="https://dano20zombie.github.io/styles.css">







  <link rel="shortcut icon" href="https://dano20zombie.github.io/favicon.ico">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="ar" />
<meta property="og:type" content="article" />
<meta property="og:title" content="CppOnionBridge: الابتكار في الوصول المجهول إلى الإنترنت">
<meta property="og:description" content="استكشف CppOnionBridge، الحل النهائي لتصفح الإنترنت بشكل مجهول. يستكشف هذا المنشور كيف يوفر المشروع وصولًا آمنًا ومحميًا إلى مواقع البصل وواجهات برمجة التطبيقات من خلال شبكة Tor، مؤكدًا أهمية الخصوصية والأمان على الإنترنت في عصر رقمي. مثالي لمستخدمي Windows الذين يسعون إلى تعزيز تجربتهم عبر الإنترنت مع الحفاظ على هويتهم الرقمية محمية." />
<meta property="og:url" content="https://dano20zombie.github.io/ar/posts/cpponionbridge/" />
<meta property="og:site_name" content="مدونة دانو20زومبي" />

  
    <meta property="og:image" content="https://dano20zombie.github.io/favicon.ico">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="الأمان" />

  <meta property="article:section" content="التكنولوجيا" />


  <meta property="article:published_time" content="2024-02-17 00:00:00 &#43;0000 UTC" />












</head>
<body class="red">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/ar">
  <div class="logo">
    مدونة دانو20زومبي
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/ar/showcase">عرض</a></li>
        
      
        
          <li><a href="/ar/about">عني</a></li>
        
      
      
        <hr />
        
          <li>
            <a href="https://dano20zombie.github.io/en/">English</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/zh/">中文</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/es/">Español</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/fr/">Français</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/it/">Italiano</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/ar/">العربية</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/de/">Deutsch</a>
          </li>
        
          <li>
            <a href="https://dano20zombie.github.io/ru/">Русский</a>
          </li>
        
      
    </ul>
  </li>
</ul>

    
    
      <ul class="menu menu--desktop menu--language-selector">
  <li class="menu__trigger">العربية&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        <li><a href="https://dano20zombie.github.io/en/">English</a></li>
      
        <li><a href="https://dano20zombie.github.io/zh/">中文</a></li>
      
        <li><a href="https://dano20zombie.github.io/es/">Español</a></li>
      
        <li><a href="https://dano20zombie.github.io/fr/">Français</a></li>
      
        <li><a href="https://dano20zombie.github.io/it/">Italiano</a></li>
      
        <li><a href="https://dano20zombie.github.io/ar/">العربية</a></li>
      
        <li><a href="https://dano20zombie.github.io/de/">Deutsch</a></li>
      
        <li><a href="https://dano20zombie.github.io/ru/">Русский</a></li>
      
    </ul>
  </li>
</ul>

    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/ar/showcase" >عرض</a></li>
        
      
        
          <li><a href="/ar/about" >عني</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://dano20zombie.github.io/ar/posts/cpponionbridge/">CppOnionBridge: الابتكار في الوصول المجهول إلى الإنترنت</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-02-17</time><span class="post-reading-time">7 min read (1380 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://dano20zombie.github.io/ar/tags/cpponionbridge/">CppOnionBridge</a>&nbsp;
      
      #<a href="https://dano20zombie.github.io/ar/tags/%D8%B4%D8%A8%D9%83%D8%A9-tor/">شبكة Tor</a>&nbsp;
      
      #<a href="https://dano20zombie.github.io/ar/tags/%D8%A7%D9%84%D8%AA%D8%AC%D9%87%D9%8A%D8%B2-%D8%B9%D8%A8%D8%B1-%D8%A7%D9%84%D8%A5%D9%86%D8%AA%D8%B1%D9%86%D8%AA/">التجهيز عبر الإنترنت</a>&nbsp;
      
      #<a href="https://dano20zombie.github.io/ar/tags/%D8%A7%D9%84%D8%A3%D9%85%D8%A7%D9%86-%D8%A7%D9%84%D8%B3%D9%8A%D8%A8%D8%B1%D8%A7%D9%86%D9%8A/">الأمان السيبراني</a>&nbsp;
      
      #<a href="https://dano20zombie.github.io/ar/tags/c&#43;&#43;/">C&#43;&#43;</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="تنويه">تنويه<a href="#تنويه" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>يهدف هذا المنشور ومشروع CppOnionBridge إلى تعزيز الخصوصية والأمان على الإنترنت. يجب دائمًا استخدام الأدوات لتصفح الإنترنت بشكل مجهول وفقًا للقوانين واللوائح المحلية. نذكركم بأن المسؤولية عن استخدام مثل هذه الأدوات تقع على المستخدم النهائي. يتم توفير هذا المحتوى &ldquo;كما هو&rdquo;، دون أي نوع من الضمان بشأن دقته أو توقيته.</p>
<h2 id="مقدمة">مقدمة<a href="#مقدمة" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>في السياق الحالي، حيث تتعرض الخصوصية على الإنترنت لتهديد مستمر، يظهر <strong>CppOnionBridge</strong> كحلاً رائدًا لضمان وصول مجهول وآمن إلى الإنترنت. يسمح هذا المشروع، الذي تم تطويره بتركيز على بيئات Windows، بالتنقل بشكل آمن إلى مواقع البصل وواجهات برمجة التطبيقات من خلال شبكة Tor، باستخدام بروتوكول SOCKS5.</p>
<h2 id="رؤية">رؤية<a href="#رؤية" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>الرؤية وراء <strong>CppOnionBridge</strong> واضحة: توفير أداة لا تحمي فقط هوية مستخدمي الإنترنت ولكن تجعل أيضًا قوة شبكة Tor متاحة للمطورين والمستخدمين النهائيين بجهد تقني أدنى، حيث يحتوي هذا المشروع على تعقيدات اتصالات SSL/TLS وطلبات HTTP(S) من خلال Tor، مما يسمح بالتركيز على وظائف التطبيق.</p>
<h2 id="الميزات-والفوائد">الميزات والفوائد<a href="#الميزات-والفوائد" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li><strong>سهولة الاندماج</strong>: مصمم ليكون سهل الاندماج في تطبيقات C++، يقلل <strong>CppOnionBridge</strong> من حاجز الدخول لتطوير التطبيقات الآمنة.</li>
</ul>
<h2 id="الميزات-والفوائد-1">الميزات والفوائد<a href="#الميزات-والفوائد-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li><strong>سهولة الاندماج</strong>: مصمم ليكون متكاملًا بسهولة في تطبيقات C++، يقلل <strong>CppOnionBridge</strong> من حاجز الدخول لتطوير التطبيقات الآمنة.</li>
<li><strong>الاعتماديات الدنيا</strong>: بالاعتماد فقط على Boost لعمليات الشبكة والنظام و OpenSSL للاتصالات المشفرة، يبقى البرنامج خفيفًا وغير متعلق ببيئة التطوير.</li>
<li><strong>توافق SOCKS5</strong>: يضمن تفاعلًا سلسًا وآمنًا مع شبكة Tor، مما يفتح الطريق لمجموعة واسعة من التطبيقات التي تتطلب السرية والأمان.</li>
</ul>
<h2 id="ما-هو-socks5">ما هو SOCKS5<a href="#ما-هو-socks5" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>SOCKS هو بروتوكول إنترنت يتبادل حزم الشبكة بين العميل والخادم من خلال خادم وكيل. يوفر بروتوكول SOCKS5 اختياريًا المصادقة، بحيث يمكن للمستخدمين المعتمدين فقط الوصول إلى خادم.</p>
<h2 id="لماذا-socks5">لماذا SOCKS5<a href="#لماذا-socks5" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>تم اختيار بروتوكول SOCKS5 لمرونته وأمانه. تتيح هندسته العميل-الخادم تغليف طلبات HTTP(S) واتصالات SSL/TLS من خلال Tor، مما يضمن تفاعلًا آمنًا ومجهولًا مع الشبكة. علاوة على ذلك، توافقه مع مجموعة واسعة من التطبيقات يجعله خيارًا مثاليًا لضمان السرية والأمان على الإنترنت. (<a href="https://en.wikipedia.org/wiki/SOCKS">ويكيبيديا</a>)
يعمل خادم SOCKS5 كوكيل بينك وبين الخادم النهائي، يرسل الحزم من جهاز الكمبيوتر الخاص بك إلى الجانب الآخر من الاتصال، والعكس.
يوفر TOR بالفعل لنا واجهة SOCKS5، والتي تعتمد على المنفذ المحلي الافتراضي 9050، ولكن في هذا المثال، سنستخدم المنفذ 9150.</p>
<h2 id="كيف-يعمل">كيف يعمل<a href="#كيف-يعمل" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>يعتمد CppOnionBridge على مكتبتين خارجيتين: Boost و OpenSSL، لذا دعونا نبدأ بتضمينهما في مشروعنا:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/asio.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/beast.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/beast/http.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/beast/ssl.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/beast/version.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/asio/connect.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/asio/ip/tcp.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/asio/ssl/error.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;boost/asio/ssl/stream.hpp&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#pragma comment(lib, &#34;libcrypto64MD.lib&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#pragma comment(lib, &#34;libssl64MD.lib&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;Windows.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Definizioni di namespace per semplificare il codice
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">namespace</span> beast <span style="color:#f92672">=</span> boost<span style="color:#f92672">::</span>beast;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> http <span style="color:#f92672">=</span> beast<span style="color:#f92672">::</span>http;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> ssl <span style="color:#f92672">=</span> boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>ssl;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> asio <span style="color:#f92672">=</span> boost<span style="color:#f92672">::</span>asio;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> error <span style="color:#f92672">=</span> boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>error;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> tcp <span style="color:#f92672">=</span> asio<span style="color:#f92672">::</span>ip<span style="color:#f92672">::</span>tcp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> std<span style="color:#f92672">::</span>string <span style="color:#66d9ef">const</span> host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bible4u2lvhacg4b3to2e2veqpwmrc2c3tjf2wuuqiz332vlwmr4xbad.onion&#34;</span>; <span style="color:#75715e">// Bible4u
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> std<span style="color:#f92672">::</span>string <span style="color:#66d9ef">const</span> api <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/en/about&#34;</span>; <span style="color:#75715e">// About Page
</span></span></span></code></pre></div><p>بعد القيام بذلك، كخطوتنا الفعلية الأولى، نحتاج إلى إنشاء مأخذ والاتصال بعنوان المضيف المحلي، مع المنفذ المحدد لدينا (127.0.0.1:9150):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>asio<span style="color:#f92672">::</span>io_context io_context;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tcp<span style="color:#f92672">::</span>socket socket(io_context);
</span></span><span style="display:flex;"><span>tcp<span style="color:#f92672">::</span>resolver resolver(io_context);
</span></span><span style="display:flex;"><span>ssl<span style="color:#f92672">::</span>stream<span style="color:#f92672">&lt;</span>tcp<span style="color:#f92672">::</span>socket<span style="color:#f92672">&amp;&gt;*</span> ssl_stream <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">auto</span> endpoints <span style="color:#f92672">=</span> resolver.resolve(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, <span style="color:#e6db74">&#34;9150&#34;</span>);
</span></span><span style="display:flex;"><span>asio<span style="color:#f92672">::</span>connect(socket, endpoints);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Connessione stabilita con successo.&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span></code></pre></div><p>بمجرد الاتصال بالمأخذ، أول ما يجب القيام به هو إرسال التحية الأولية إلى الخادم، للتواصل بأننا نريد استخدام بروتوكول SOCKS5.
للحصول على معلومات مفصلة حول SOCKS5، يمكنك الرجوع إلى <a href="https://tools.ietf.org/html/rfc1928">IETF.ORG</a>
في المقام الأول، عليك أن تعرف أن التحية الأولية تتكون من ثلاث بايتات مفردة بتسلسل:</p>
<ol>
<li>
<ul>
<li>إصدار المأخذ</li>
</ul>
</li>
<li>
<ul>
<li>عدد طرق المصادقة</li>
</ul>
</li>
<li>
<ul>
<li>طرق المصادقة</li>
</ul>
</li>
</ol>
<p>بالنسبة للبايت الأول، لدينا 0x5، وهو إصدار المأخذ (SOCKS5)، أما بالنسبة للبايت الثاني، فلدينا عدد طرق المصادقة التي يدعمها العميل، حيث في هذه الحالة يقبل TOR طريقة واحدة فقط، وهي 0x1، بينما يحدد البايت الثالث الطريقة المحددة للمصادقة، والتي في هذه الحالة ستكون 0x0، مما يعني عدم وجود مصادقة.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Send the SOCKS5 greeting.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>socket.send(boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>buffer(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x05\x01\x00</span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">3</span>));
</span></span></code></pre></div><p>في هذه النقطة، نحتاج فقط إلى قراءة الاستجابة التي تم إرجاعها بواسطة البروكسي لمعرفة ما إذا كان كل شيء تم بنجاح أم لا، من خلال قراءة البايت الثاني من الاستجابة، الذي يجب أن يكون دائمًا 0x0.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Receive the response to the SOCKS5 greeting.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> response[<span style="color:#ae81ff">2</span>];
</span></span><span style="display:flex;"><span>size_t length <span style="color:#f92672">=</span> socket.receive(boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>buffer(response, <span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Check the response to the SOCKS5 greeting.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (length <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">||</span> response[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\x00&#39;</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span></code></pre></div><p>إذا كل شيء تم بنجاح، كل ما تبقى هو إخبار خادم الوكيل بالاتصال بمضيف محدد بالنسبة لنا، حتى نتمكن من إرسال الطلبات واستقبالها.
سنقوم بالمتابعة بنفس الطريقة كالتحية الأولية ولكن ببايتات مختلفة. في هذه الحالة، لدينا أربع بايتات أولية، المضيف المحدد، وبايت واحد أو اثنين نهائية لتحديد المنفذ (HTTP/HTTPS - 80/443).</p>
<ol>
<li>
<ul>
<li>إصدار المأخذ</li>
</ul>
</li>
<li>
<ul>
<li>الأمر</li>
</ul>
</li>
<li>
<ul>
<li>محجوز</li>
</ul>
</li>
<li>
<ul>
<li>نوع العنوان</li>
</ul>
</li>
<li>
<ul>
<li>طول العنوان (فقط إذا كان نوع النطاق)</li>
</ul>
</li>
<li>
<ul>
<li>العنوان</li>
</ul>
</li>
<li>
<ul>
<li>المنفذ</li>
</ul>
</li>
</ol>
<p>كما البايت الأول، لدينا 0x5، وهو إصدار المأخذ (SOCK-5)، وكما البايت الثاني، لدينا الأمر الذي نريد تنفيذه، حيث في هذه الحالة سيكون 0x1، مما يعني الاتصال، وكما البايت الثالث لدينا بايت محجوز، الذي يجب أن يكون دائمًا 0x0، وكما البايت الرابع لدينا نوع العنوان الذي نحدده، حيث في هذه الحالة سيكون 0x3، مما يعني عنوان نطاق، ولكن يمكن أيضًا أن يكون 0x1 للاتصال بـ IPv4، أو 0x4 للاتصال بـ IPv6.
بعد هذه البايتات، من الضروري تحديد طول النطاق الذي نريد الاتصال به، في البايت الخامس، وفورًا بعد ذلك تحديد المضيف عبر النطاق، وكأخر بايت واحد أو اثنين لدينا المنفذ الذي نريد الاتصال به، حيث الأكثر شيوعًا هم 80 (0x50) لـ HTTP، و 443 (0x01 0xBB) لـ HTTPS.
جميع الأوامر المتاحة مرئية وموثقة على موقع <a href="https://tools.ietf.org/html/rfc1928">IETF.ORG</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>byte<span style="color:#f92672">*</span> request <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> byte[<span style="color:#ae81ff">256</span>];
</span></span><span style="display:flex;"><span>memset(request, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(request));
</span></span><span style="display:flex;"><span>sprintf(request, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x05\x01\x00\x03</span><span style="color:#e6db74">%c%s</span><span style="color:#ae81ff">\x01\xBB</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>(host.size()), host.c_str());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Send the request.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>socket.send(boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>buffer(request, <span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> host.size()));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">delete</span>[] request;
</span></span></code></pre></div><p>أخيرًا، نحتاج فقط إلى التحقق كالعادة من استجابة الخادم، حيث يجب أن تكون طولها عشر بايتات في هذه الحالة، سنقرأ حصريًا البايت الثاني، حيث يُعيد حالة طلبنا.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Receive the response to the SOCKS5 connection request.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> buffer[<span style="color:#ae81ff">10</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> length_response <span style="color:#f92672">=</span> socket.receive(boost<span style="color:#f92672">::</span>asio<span style="color:#f92672">::</span>buffer(buffer, <span style="color:#ae81ff">10</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (length_response <span style="color:#f92672">!=</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">||</span> buffer[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;\x00&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 0x1: General failure of the socket
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x2: Connection&#39;s rule not allowed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x3: Network not available
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x4: Host not available
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x5: Connection refused (SOCK5 not available)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x6: Timeout
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x7: Command not supported
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 0x8: Address type not supported
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>قد لا تقبل بعض النطاقات البصلية الاتصالات الواردة عبر SOCK5، في هذه الحالة، إذا لم تكن صاحب النطاق، فليس هناك الكثير مما يمكن القيام به.
ومع ذلك، في هذه النقطة، يمكننا المتابعة بإرسال الطلب الفعلي.
إذا تم إجراء طلب HTTPS، فمن الضروري إرسال الطلب المشفر، من خلال تيار SSL مع التصافح المناسب، وإلا لن يتمكن الخادم من تفسيره.
من ناحية أخرى، يجب تجنب ذلك إذا تم إجراء طلب HTTP، حيث في هذه الحالة يتوقع الخادم طلبًا واضحًا، وبالتالي غير مشفر.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Create the SSL stream for the new connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ssl<span style="color:#f92672">::</span>context ctx(ssl<span style="color:#f92672">::</span>context<span style="color:#f92672">::</span>sslv23);
</span></span><span style="display:flex;"><span>ssl_stream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ssl<span style="color:#f92672">::</span>stream<span style="color:#f92672">&lt;</span>tcp<span style="color:#f92672">::</span>socket<span style="color:#f92672">&amp;&gt;</span>(socket, ctx);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Perform the SSL/TLS handshake
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ssl_stream<span style="color:#f92672">-&gt;</span>handshake(ssl<span style="color:#f92672">::</span>stream_base<span style="color:#f92672">::</span>client);
</span></span></code></pre></div><p>بعد أداء تيار SSL وتصافحه (إذا لزم الأمر لبروتوكول HTTPS)، نقوم بإرسال الطلب الفعلي:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Prepare the HTTP request
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>std<span style="color:#f92672">::</span>string target <span style="color:#f92672">=</span> api;
</span></span><span style="display:flex;"><span>http<span style="color:#f92672">::</span>request<span style="color:#f92672">&lt;</span>http<span style="color:#f92672">::</span>string_body<span style="color:#f92672">&gt;</span> req(http<span style="color:#f92672">::</span>verb<span style="color:#f92672">::</span>get, target, <span style="color:#ae81ff">11</span>); <span style="color:#75715e">// Si specifica il metodo (GET/POST/PUT), l&#39;host e la versione dell&#39;HTTP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>req.set(http<span style="color:#f92672">::</span>field<span style="color:#f92672">::</span>host, host); <span style="color:#75715e">// Si specifica l&#39;host
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>req.set(http<span style="color:#f92672">::</span>field<span style="color:#f92672">::</span>user_agent, <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 6.1; rv:31.0) Gecko/20100101 Firefox/31.0&#34;</span>); <span style="color:#75715e">// Si specifica l&#39;User-Agent (Browser)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>req.set(http<span style="color:#f92672">::</span>field<span style="color:#f92672">::</span>connection, <span style="color:#e6db74">&#34;keep-alive&#34;</span>); <span style="color:#75715e">// Si specifica la connessione come persistente (Opzionale)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Send the HTTP request over the SSL connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>http<span style="color:#f92672">::</span>write(<span style="color:#f92672">*</span>ssl_stream, req);
</span></span></code></pre></div><p>ف
ي هذه النقطة، كل ما تبقى هو استقبال الرد النهائي على طلبنا مع رمز الخروج لمعرفة نتيجة الطلب.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Receive the HTTP response
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>beast<span style="color:#f92672">::</span>flat_buffer buffer;
</span></span><span style="display:flex;"><span>http<span style="color:#f92672">::</span>response<span style="color:#f92672">&lt;</span>http<span style="color:#f92672">::</span>dynamic_body<span style="color:#f92672">&gt;</span> res;
</span></span><span style="display:flex;"><span>http<span style="color:#f92672">::</span>read(<span style="color:#f92672">*</span>ssl_stream, buffer, res); <span style="color:#75715e">//Otteniamo la risposta e salviamola in res
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>string req_response <span style="color:#f92672">=</span> beast<span style="color:#f92672">::</span>buffers_to_string(res.body().data()); <span style="color:#75715e">// Convertiamo la risposta in una stringa
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (res.result_int() <span style="color:#f92672">!=</span> <span style="color:#ae81ff">200</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; <span style="color:#75715e">// 200 = HTTP_OK
</span></span></span></code></pre></div><p>بمجرد الانتهاء من طلبنا، نحتاج إلى إغلاق الاتصال مع خادم البروكسي وتحرير الذاكرة المخصصة لتيار SSL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>boost<span style="color:#f92672">::</span>system<span style="color:#f92672">::</span>error_code ec;
</span></span><span style="display:flex;"><span>ssl_stream<span style="color:#f92672">-&gt;</span>shutdown(ec); <span style="color:#75715e">// Spegniamo lo stream SSL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">delete</span> ssl_stream;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>socket.close(); <span style="color:#75715e">// Chiudiamo il socket
</span></span></span></code></pre></div><p>وها نحن قد قمنا بنجاح بطلبنا واستلمنا الرد.</p>
<h2 id="دليل-التثبيت">دليل التثبيت<a href="#دليل-التثبيت" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>يتطلب تثبيت <strong>CppOnionBridge</strong> بعض الخطوات الأولية، بما في ذلك تكوين Boost و OpenSSL في بيئة التطوير الخاصة بك، بالإضافة إلى وجود نسخة نشطة من خدمة Tor مكونة للعمل عبر المنفذ 9150.</p>
<h3 id="خطوات-التثبيت">خطوات التثبيت:<a href="#خطوات-التثبيت" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ol>
<li>تأكد من تثبيت Boost و OpenSSL وتكوينهما بشكل صحيح في النظام.</li>
<li>تحقق من أن خدمة Tor نشطة ومضبوطة للاتصال عبر المنفذ 9150.</li>
<li>استنسخ مستودع GitHub لـ <strong>CppOnionBridge</strong> وقم بتضمينه في مشروعك.</li>
</ol>
<h2 id="المساهمة-في-المشروع">المساهمة في المشروع<a href="#المساهمة-في-المشروع" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><strong>CppOnionBridge</strong> هو مشروع مفتوح المصدر، والمشاركة المجتمعية أمر أساسي لتطويره وتحسينه المستمر. إذا كنت مهتمًا بالمساهمة، سواء من خلال الكود، الوثائق، أو الاختبار، قم بزيارة <a href="https://github.com/dano20zombie/CppOnionBridge">مستودع GitHub</a>.</p>
<h2 id="الاستنتاج">الاستنتاج<a href="#الاستنتاج" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><strong>CppOnionBridge</strong> يمثل خطوة هامة نحو تحقيق الوصول الآمن والمجهول إلى الإنترنت. مع سهولة التكامل، والاعتمادات الدنيا، والتوافق مع شبكة Tor، يفتح آفاقًا جديدة لتطوير التطبيقات التي تحترم خصوصية وأمان المستخدمين.</p>
<p>لمزيد من التفاصيل، المراجع، ودلائل التثبيت، راجع <a href="https://github.com/dano20zombie/CppOnionBridge">الوثائق الكاملة</a> المتوفرة في مستودع GitHub.</p>

      </div></div>

  
    
  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2024 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
